# electron-builder.yml

# The unique application ID
appId: com.whisper.app

# The user-facing application name
productName: Whisper

# Publish configuration for GitHub releases
publish:
    provider: github
    owner: ThanosKa
    repo: whisper-desktop
    releaseType: draft

# Protocols configuration for deep linking
protocols:
    name: Whisper Protocol
    schemes:
        - whisper

# List of files to be included in the app package
files:
    - src/**/*
    - package.json
    - whisper_web/backend_node/dist/**/*
    - '!**/node_modules/electron/**'
    - public/build/**/*

# Additional resources to be copied into the app's resources directory
extraResources:
    - from: whisper_web/out
      to: out

asarUnpack:
    - 'src/ui/assets/SystemAudioDump'
    - '**/node_modules/sharp/**/*'
    - '**/node_modules/@img/**/*'

# Windows configuration
win:
    icon: src/ui/assets/wlogo.ico
    target:
        - target: nsis
          arch: x64
    requestedExecutionLevel: asInvoker
    signAndEditExecutable: false
    # cscLink: build\certs\glass-dev.pfx
    # cscKeyPassword: '${env.CSC_KEY_PASSWORD}'
    # signtoolOptions:
    #     certificateSubjectName: 'Whisper Dev Code Signing'

# NSIS installer configuration for Windows
nsis:
    oneClick: false
    perMachine: false
    allowToChangeInstallationDirectory: true
    deleteAppDataOnUninstall: true
    createDesktopShortcut: always
    createStartMenuShortcut: true
    shortcutName: Whisper

# macOS specific configuration
mac:
    # The application category type
    category: public.app-category.utilities
    # Path to the .icns icon file
    icon: src/ui/assets/wlogo.icns
    # Minimum macOS version (supports both Intel and Apple Silicon)
    minimumSystemVersion: '11.0'
    hardenedRuntime: true
    entitlements: entitlements.plist
    entitlementsInherit: entitlements.plist
    # Code signing identity
    identity: 'Thanos Kazakis (GJ3U78VY54)'
    target:
        - target: dmg
          arch: universal
        - target: zip
          arch: universal

# Hook to run after signing (for notarization)
afterSign: notarize.js

# Linux configuration
linux:
    # The application category
    category: AudioVideo
    # Path to the icon file
    icon: src/ui/assets/wlogo.png
    # Package targets
    target:
        - target: AppImage
          arch: [x64, arm64]
        - target: deb
          arch: [x64, arm64]
        - target: rpm
          arch: [x64, arm64]
    # Desktop file configuration
    desktop:
        Name: Whisper
        Comment: AI-powered meeting assistant
        Categories: AudioVideo;Office;
